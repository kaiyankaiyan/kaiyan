<?xml version="1.0" encoding="UTF-8"?>
<mily-mappings package="com.haoyong.sales.sale.form">
	<import>net.sf.mily.support.form.*</import>
	<import>com.haoyong.sales.common.listener.*</import>
	<import>com.haoyong.sales.sale.domain.*</import>
	<import>com.haoyong.sales.sale.form.*</import>
	<import>com.haoyong.sales.base.domain.*</import>
	<import>com.haoyong.sales.base.form.*</import>
	<class name="BOrderTicketForm" label="总部订单备货">
		<view name="Create" builder="EditViewBuilder">
			<param name="menu">
				<attribute name="text" value="提交" />
				<attribute name="image" value="mily/img/color.gif" />
				<param name="listener">
					<attribute name="class" value="ValidateListener" />
					<attribute name="setter" value="validateCreate" />
				</param>
				<param name="listener">
					<attribute name="class" value="ActionServiceListener" />
					<param name="action">
						<attribute name="action" value="OrderTicket_T" />
						<attribute name="setter" value="setTicket4Service" />
						<attribute name="message" value="保存订单单头" />
					</param>
					<param name="action">
						<attribute name="action" value="OrderTicket_Save" />
						<attribute name="setter" value="setCreate4Service" />
						<attribute name="message" value="新增订单生效，计算够用数量" />
						<param name="state">
							<attribute name="id" value="30" />
							<attribute name="name" value="新增订单" />
							<attribute name="method" value="setOrderState" />
						</param>
						<param name="user">
							<attribute name="method" value="setOrderUser" />
						</param>
					</param>
					<param name="action">
						<attribute name="action" value="OrderTicket_Save" />
						<attribute name="setter" value="setArrange4Service" />
						<attribute name="message" value="备货订单开单安排请购" />
						<param name="state">
							<attribute name="id" value="30" />
							<attribute name="name" value="备货订单安排请购" />
							<attribute name="method" value="setArrangeState" />
						</param>
						<param name="user">
							<attribute name="method" value="setArrangeUser" />
						</param>
					</param>
					<param name="action">
						<attribute name="action" value="OrderTicket_Effect" />
						<attribute name="setter" value="setEffect4Service" />
					</param>
				</param>
				<param name="listener">
					<attribute name="class" value="ActionServiceListener" />
					<attribute name="type" value="UnTransaction" />
					<param name="action">
						<attribute name="action" value="OrderTicket_Count" />
						<attribute name="property" value="DetailList" />
						<attribute name="message" value="订单全单统计" />
					</param>
				</param>
				<param name="listener">
					<attribute name="class" value="RedirectorListener" />
					<attribute name="url" value="success.jsp" />
				</param>
			</param>
			<property name="domain" class="OrderDetail">
				<property name="OrderTicket.Ticket" class="OrderTicket" />
				<property name="client" class="Client" />
				<property name="subCompany" class="SubCompany" />
			</property>
			<property name="detailList" class="OrderDetail" builder="EditListBuilder">
				<param name="menu">
					<attribute name="text" value="添加明细" />
					<attribute name="image" value="mily/img/color.gif" />
					<param name="listener">
						<attribute name="class" value="PostListener" />
						<attribute name="method" value="addDetail" />
					</param>
					<param name="listener">
						<attribute name="class" value="RefreshListener" />
					</param>
				</param>
				<param name="menu">
					<attribute name="text" value="移除明细" />
					<attribute name="image" value="mily/img/color.gif" />
					<param name="listener">
						<attribute name="class" value="SelectDeleteListener" />
					</param>
					<param name="listener">
						<attribute name="class" value="RefreshListener" />
					</param>
				</param>
				<property name="commodity" class="Commodity" />
				<property name="amount" label="数量" builder="TextFieldBuilder" />
				<property name="OrderTicket.Detail" class="OrderTicket" />
				<property name="remark" label="明细备注" builder="TextFieldBuilder"/>
			</property>
		</view>
	</class>
</mily-mappings>
